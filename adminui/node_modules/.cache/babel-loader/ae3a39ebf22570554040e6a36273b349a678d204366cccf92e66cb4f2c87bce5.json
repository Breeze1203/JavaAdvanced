{"ast":null,"code":"import request from \"@/util/requestUtil\";\nimport { ElMessage, ElMessageBox } from \"element-plus\";\nexport default {\n  name: 'RoleSet',\n  data() {\n    return {\n      roles: [],\n      // 所有角色数组\n      Permissions: [],\n      //所有权限数组\n      checked: [],\n      //复选框选中的值，\n      activity: null,\n      updateVisible: false,\n      role: {\n        id: null,\n        role_name: null,\n        nameZh: null\n      },\n      permission: {\n        rid: '',\n        allId: ''\n      }\n    };\n  },\n  methods: {\n    handleTabClick(tab) {\n      // 将角色id作为tab的name\n      request.getPermissionByRole(tab.props.name).then(resp => {\n        if (resp.data != null) {\n          this.checked = resp.data;\n        }\n      });\n    },\n    changePermission(item) {\n      // 修改权限\n      ElMessageBox.confirm('此操作将会修改【' + item.nameZh + '】权限，是否继续?', 'Warning', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.permission.allId = this.checked;\n        this.permission.rid = item.id;\n        request.updatePermission(JSON.stringify(this.permission)).then(resp => {\n          if (resp.data.code === 200) {\n            ElMessage.success(resp.data.message);\n            this.activity = null;\n          } else {\n            ElMessage.error(resp.data.message);\n          }\n        });\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '操作取消'\n        });\n      });\n    },\n    // 获取所有角色\n    getAllRoles() {\n      request.getAllRoles().then(resp => {\n        if (resp.data != null) {\n          this.roles = resp.data;\n        }\n      });\n    },\n    // 添加角色\n    addRole() {\n      if (this.role.nameZh == null || this.role.role_name == null) {\n        ElMessage.error(\"请输入要添加的角色名称\");\n        return;\n      }\n      request.addRole(this.role).then(resp => {\n        if (resp.data.code === 200) {\n          ElMessage.success(resp.data.message);\n          this.role.nameZh = null;\n          this.role.role_name = null;\n          this.getAllRoles();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      });\n    },\n    // 编辑角色\n    updateRole(data) {\n      this.updateVisible = true;\n      this.role.id = data.id;\n      this.role.role_name = data.role_name;\n      this.role.nameZh = data.nameZh;\n    },\n    // 取消修改角色\n    cancelUpdate() {\n      this.updateVisible = false;\n      this.role.id = null;\n      this.role.role_name = null;\n      this.role.nameZh = null;\n    },\n    // 确定修改角色\n    sureUpdate() {\n      request.updateRole(this.role).then(resp => {\n        if (resp.data.code === 200) {\n          ElMessage.success(resp.data.message);\n          this.getAllRoles();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      });\n      this.cancelUpdate();\n    },\n    // 删除角色\n    DeleteRole(data) {\n      request.deleteRole(data.id).then(resp => {\n        if (resp.data.code === 200) {\n          ElMessage.success(resp.data.message);\n          this.getAllRoles();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      });\n    },\n    // 获取所有权限\n    initAllPermission() {\n      request.getAllPermission().then(resp => {\n        if (resp.data != null) {\n          this.Permissions = resp.data;\n        }\n      });\n    }\n  },\n  mounted() {\n    this.getAllRoles();\n    this.initAllPermission();\n  }\n};","map":{"version":3,"names":["request","ElMessage","ElMessageBox","name","data","roles","Permissions","checked","activity","updateVisible","role","id","role_name","nameZh","permission","rid","allId","methods","handleTabClick","tab","getPermissionByRole","props","then","resp","changePermission","item","confirm","confirmButtonText","cancelButtonText","type","updatePermission","JSON","stringify","code","success","message","error","catch","getAllRoles","addRole","updateRole","cancelUpdate","sureUpdate","DeleteRole","deleteRole","initAllPermission","getAllPermission","mounted"],"sources":["/Users/pt/Documents/code/adminflowui/src/components/set/RoleSet.vue"],"sourcesContent":["<template>\n  <div class=\"common-layout\" style=\"margin-top: 25px\">\n    <el-container class=\"shadow-box\">\n      <el-aside width=\"200px\">\n        <div style=\"border-bottom: 1px solid;text-align: center\">\n          <h4>角色管理</h4>\n        </div>\n        <div class=\"tag-container\" v-for=\"(item,index) in roles\" :key=\"index\">\n          <el-tag size=\"large\" class=\"custom-tag\">{{ item.nameZh }}\n            <el-dropdown size=\"small\" trigger=\"hover\">\n              <el-icon>\n                <Setting/>\n              </el-icon>\n              <template #dropdown>\n                <el-dropdown-menu>\n                  <el-dropdown-item @click=\"updateRole(item)\">编辑</el-dropdown-item>\n                  <el-dropdown-item @click=\"DeleteRole(item)\">删除</el-dropdown-item>\n                </el-dropdown-menu>\n              </template>\n            </el-dropdown>\n          </el-tag>\n        </div>\n      </el-aside>\n      <el-container>\n        <el-header>\n          <div class=\"container\">\n            <el-input placeholder=\"请输入角色英文\" v-model=\"role.role_name\" style=\"width: 200px\" type=\"text\">\n              <template #prepend>role_</template>\n            </el-input>\n            <el-input v-model=\"role.nameZh\" placeholder=\"请输入角色中文名称\" style=\"width: 200px;margin-left: 20px\" type=\"text\">\n            </el-input>\n            <el-button @click=\"addRole\" style=\"margin-left: 20px\" type=\"primary\">添加角色\n              <el-icon>\n                <Plus/>\n              </el-icon>\n            </el-button>\n          </div>\n        </el-header>\n        <el-main>\n          <div>\n            <el-tabs @tab-click=\"handleTabClick\" v-model=\"activity\">\n              <el-tab-pane v-for=\"(item, index) in roles\" :name=\"item.id\" :key=\"index\" :label=\"item.nameZh\">\n                <el-checkbox-group v-model=\"checked\">\n                  <el-checkbox v-for=\"(permission, index) in Permissions\" :label=\"permission.id\" :key=\"index\">\n                    {{ permission.describe }}\n                  </el-checkbox>\n                </el-checkbox-group>\n                <div style=\"justify-content: end;display: flex\">\n                  <el-button type=\"primary\" @click=\"changePermission(item)\">保存</el-button>\n                </div>\n              </el-tab-pane>\n            </el-tabs>\n          </div>\n        </el-main>\n      </el-container>\n    </el-container>\n  </div>\n  <el-dialog v-model=\"updateVisible\" title=\"修改角色\" width=\"40%\" center>\n    <span>\n     <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>角色英文名：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input style=\"width: 300px\" v-model=\"role.role_name\" size=\"small\"/>\n      </el-col>\n    </el-row>\n      <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>角色中文名：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input style=\"width: 300px\" v-model=\"role.nameZh\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    </span>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"cancelUpdate\">取消</el-button>\n        <el-button type=\"primary\" @click=\"sureUpdate\">\n          确定\n        </el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n\n<script>\nimport request from \"@/util/requestUtil\";\nimport {ElMessage, ElMessageBox} from \"element-plus\";\n\nexport default {\n  name: 'RoleSet',\n  data() {\n    return {\n      roles: [], // 所有角色数组\n      Permissions: [], //所有权限数组\n      checked: [], //复选框选中的值，\n      activity:null,\n      updateVisible:false,\n      role:{\n        id:null,\n        role_name:null,\n        nameZh:null\n      },\n      permission: {\n        rid: '',\n        allId: ''\n      },\n    }\n  },\n  methods: {\n    handleTabClick(tab) {\n      // 将角色id作为tab的name\n      request.getPermissionByRole(tab.props.name).then(resp => {\n        if (resp.data != null) {\n          this.checked = resp.data;\n        }\n      })\n    },\n    changePermission(item) {\n      // 修改权限\n      ElMessageBox.confirm(\n          '此操作将会修改【'+item.nameZh+'】权限，是否继续?',\n          'Warning',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning',\n          }\n      )\n          .then(() => {\n            this.permission.allId=this.checked;\n            this.permission.rid=item.id;\n            request.updatePermission(JSON.stringify(this.permission)).then(resp=>{\n              if(resp.data.code===200){\n                ElMessage.success(resp.data.message);\n                this.activity=null;\n              }else {\n                ElMessage.error(resp.data.message);\n              }\n            })\n          })\n          .catch(() => {\n            ElMessage({\n              type: 'info',\n              message: '操作取消',\n            })\n          })\n    },\n    // 获取所有角色\n    getAllRoles() {\n      request.getAllRoles().then(resp => {\n        if (resp.data != null) {\n          this.roles = resp.data;\n        }\n      })\n    },\n    // 添加角色\n    addRole(){\n      if(this.role.nameZh==null||this.role.role_name==null){\n        ElMessage.error(\"请输入要添加的角色名称\");\n        return;\n      }\n      request.addRole(this.role).then(resp=>{\n        if(resp.data.code===200){\n          ElMessage.success(resp.data.message);\n          this.role.nameZh=null;\n          this.role.role_name=null;\n          this.getAllRoles();\n        }else {\n          ElMessage.error(resp.data.message);\n        }\n      })\n    },\n    // 编辑角色\n    updateRole(data) {\n      this.updateVisible=true;\n      this.role.id=data.id;\n      this.role.role_name=data.role_name;\n      this.role.nameZh=data.nameZh;\n    },\n    // 取消修改角色\n    cancelUpdate(){\n      this.updateVisible=false;\n      this.role.id=null;\n      this.role.role_name=null;\n      this.role.nameZh=null;\n    },\n    // 确定修改角色\n    sureUpdate(){\n      request.updateRole(this.role).then(resp=>{\n        if(resp.data.code===200){\n          ElMessage.success(resp.data.message);\n          this.getAllRoles();\n        }else {\n          ElMessage.error(resp.data.message);\n        }\n      })\n      this.cancelUpdate();\n    },\n    // 删除角色\n    DeleteRole(data) {\n      request.deleteRole(data.id).then(resp=>{\n        if(resp.data.code===200){\n          ElMessage.success(resp.data.message);\n          this.getAllRoles();\n        }else {\n          ElMessage.error(resp.data.message);\n        }\n      })\n    },\n    // 获取所有权限\n    initAllPermission() {\n      request.getAllPermission().then(resp => {\n        if (resp.data != null) {\n          this.Permissions = resp.data;\n        }\n\n      })\n    },\n  },\n  mounted() {\n    this.getAllRoles();\n    this.initAllPermission();\n  }\n}\n\n</script>\n\n<style scoped>\n.shadow-box {\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4); /* 设置阴影效果 */\n  border: 1px solid #ccc; /* 设置边框 */\n  padding: 20px; /* 设置内边距，可根据需要进行调整 */\n}\n\n.tag-container {\n  display: flex;\n  flex-direction: column;\n}\n\n.custom-tag {\n  border: none;\n  background-color: #ffffff; /* 修改为你想要的颜色值 */\n  font-size: 14px; /* 修改为你想要的字体大小 */\n  color: black;\n  text-align: left;\n}\n\n.container {\n  display: flex;\n}\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}